// ============================================
// Lord'ai Ultimate - Advanced AI Engine v3.0
// ูุธุงู ุฐูุงุก ุงุตุทูุงุนู ูุชูุฏู ูุน ุฐุงูุฑุฉ ูููุฌุงุช ุนุฑุจูุฉ
// ============================================

const AIEngine = {

  // ==================== ูุธุงู ุงูุฐุงูุฑุฉ ุงููุชูุฏู ====================
  getMemory(charId) {
    const key = `lordai_memory_${charId}`;
    const m = localStorage.getItem(key);
    return m ? JSON.parse(m) : {
      facts: [],
      preferences: [],
      topics: [],
      emotions: [],
      lastInteraction: null,
      messageCount: 0,
      mood: 'neutral',
      relationshipLevel: 0,
      conversationStyle: 'formal'
    };
  },

  saveMemory(charId, mem) {
    localStorage.setItem(`lordai_memory_${charId}`, JSON.stringify(mem));
  },

  clearMemory(charId) {
    localStorage.removeItem(`lordai_memory_${charId}`);
  },

  extractFacts(text, charId) {
    const mem = this.getMemory(charId);
    const isArabic = /[\u0600-\u06FF]/.test(text);

    const patterns = [
      // Arabic patterns
      { regex: /(?:ุงุณูู|ุฃูุง ุงุณูู|ุงุณูู ูู)\s+(\S+)/g, type: 'name', lang: 'ar' },
      { regex: /(?:ุฃุญุจ|ุจุญุจ|ุฃุนุดู)\s+(.+?)(?:\.|ุ|$)/g, type: 'likes', lang: 'ar' },
      { regex: /(?:ุฃูุฑู|ูุง ุฃุญุจ|ูุด ุจุญุจ|ูุง ุจุญุจ)\s+(.+?)(?:\.|ุ|$)/g, type: 'dislikes', lang: 'ar' },
      { regex: /(?:ุฃุนูู|ุดุบูู|ูุธููุชู|ุฃุดุชุบู)\s+(.+?)(?:\.|ุ|$)/g, type: 'work', lang: 'ar' },
      { regex: /(?:ุนูุฑู|ุนูุฏู)\s+(\d+)\s*(?:ุณูุฉ|ุนุงู|ุณูู)/g, type: 'age', lang: 'ar' },
      { regex: /(?:ูู ูุฏููุฉ|ุฃุณูู ูู|ุฃุนูุด ูู|ุณุงูู ูู|ูู ุจูุฏ)\s+(.+?)(?:\.|ุ|$)/g, type: 'location', lang: 'ar' },
      { regex: /(?:ุฃุฏุฑุณ|ุชุฎุตุตู|ุจุฏุฑุณ)\s+(.+?)(?:\.|ุ|$)/g, type: 'study', lang: 'ar' },
      { regex: /(?:ููุงูุชู|ููุงูุงุชู|ุจุญุจ ุฃุณูู)\s+(.+?)(?:\.|ุ|$)/g, type: 'hobby', lang: 'ar' },
      // English patterns
      { regex: /(?:my name is|i'm|i am)\s+(\w+)/gi, type: 'name', lang: 'en' },
      { regex: /(?:i love|i like|i enjoy)\s+(.+?)(?:\.|,|$)/gi, type: 'likes', lang: 'en' },
      { regex: /(?:i hate|i dislike|i don't like)\s+(.+?)(?:\.|,|$)/gi, type: 'dislikes', lang: 'en' },
      { regex: /(?:i work as|my job is|i'm a)\s+(.+?)(?:\.|,|$)/gi, type: 'work', lang: 'en' },
      { regex: /(?:i'm|i am)\s+(\d+)\s*(?:years old)/gi, type: 'age', lang: 'en' },
      { regex: /(?:i live in|i'm from|from)\s+(.+?)(?:\.|,|$)/gi, type: 'location', lang: 'en' },
      { regex: /(?:i study|i'm studying|my major is)\s+(.+?)(?:\.|,|$)/gi, type: 'study', lang: 'en' },
      { regex: /(?:my hobby is|i enjoy doing)\s+(.+?)(?:\.|,|$)/gi, type: 'hobby', lang: 'en' },
    ];

    patterns.forEach(p => {
      let match;
      const regex = new RegExp(p.regex.source, p.regex.flags);
      while ((match = regex.exec(text)) !== null) {
        const value = match[1].trim();
        if (value.length > 1 && value.length < 100) {
          const exists = mem.facts.find(f => f.type === p.type && f.value === value);
          if (!exists) {
            mem.facts.push({ type: p.type, value, timestamp: Date.now() });
            if (mem.facts.length > 50) mem.facts.shift();
          }
        }
      }
    });

    // Detect mood from text
    const moodPatterns = {
      happy: /(?:ุณุนูุฏ|ูุฑุญุงู|ูุจุณูุท|happy|glad|great|awesome|ููุชุงุฒ|ุฑุงุฆุน|ุญูู)/i,
      sad: /(?:ุญุฒูู|ุฒุนูุงู|ุชุนุจุงู|sad|depressed|upset|ููุชุฆุจ|ูุชุถุงูู)/i,
      angry: /(?:ุบุงุถุจ|ูุนุตุจ|ุฒููุงู|angry|frustrated|mad|ูุชูุฑูุฒ)/i,
      excited: /(?:ูุชุญูุณ|ุญูุงุณ|excited|thrilled|eager|ูุชุดูู)/i,
      curious: /(?:ุฃุชุณุงุกู|ุฃุฑูุฏ ุฃุนุฑู|curious|wondering|ููู|ููุด|ููู)/i,
    };

    for (const [mood, pattern] of Object.entries(moodPatterns)) {
      if (pattern.test(text)) {
        mem.mood = mood;
        mem.emotions.push({ mood, timestamp: Date.now() });
        if (mem.emotions.length > 20) mem.emotions.shift();
        break;
      }
    }

    // Update relationship level
    mem.messageCount++;
    if (mem.messageCount > 50) mem.relationshipLevel = 3;
    else if (mem.messageCount > 20) mem.relationshipLevel = 2;
    else if (mem.messageCount > 5) mem.relationshipLevel = 1;

    // Detect conversation style
    if (text.length > 200) mem.conversationStyle = 'detailed';
    else if (text.length < 20) mem.conversationStyle = 'brief';

    mem.lastInteraction = Date.now();
    this.saveMemory(charId, mem);
    return mem;
  },

  getMemoryContext(charId) {
    const mem = this.getMemory(charId);
    if (mem.facts.length === 0) return '';
    let ctx = '';
    const nameF = mem.facts.find(f => f.type === 'name');
    if (nameF) ctx += `ุงุณู ุงููุณุชุฎุฏู: ${nameF.value}. `;
    const likeF = mem.facts.filter(f => f.type === 'likes');
    if (likeF.length) ctx += `ูุญุจ: ${likeF.map(f => f.value).join('ุ ')}. `;
    const dislikeF = mem.facts.filter(f => f.type === 'dislikes');
    if (dislikeF.length) ctx += `ูุง ูุญุจ: ${dislikeF.map(f => f.value).join('ุ ')}. `;
    const workF = mem.facts.find(f => f.type === 'work');
    if (workF) ctx += `ูุนูู: ${workF.value}. `;
    const locF = mem.facts.find(f => f.type === 'location');
    if (locF) ctx += `ูู: ${locF.value}. `;
    const ageF = mem.facts.find(f => f.type === 'age');
    if (ageF) ctx += `ุงูุนูุฑ: ${ageF.value}. `;
    const studyF = mem.facts.find(f => f.type === 'study');
    if (studyF) ctx += `ูุฏุฑุณ: ${studyF.value}. `;
    const hobbyF = mem.facts.filter(f => f.type === 'hobby');
    if (hobbyF.length) ctx += `ููุงูุงุช: ${hobbyF.map(f => f.value).join('ุ ')}. `;
    return ctx;
  },

  // ==================== ุงูุดุฎุตูุงุช ุงูุนุฑุจูุฉ ====================
  arabicCharacters: [
    {
      id: 101,
      name: 'ููุฑ',
      nameEn: 'Noor',
      description: 'ูุฑุดุฏุฉ ุฐููุฉ ุชุชุญุฏุซ ุจุงูุนุฑุจูุฉ ุงููุตุญู. ุฎุจูุฑุฉ ูู ุงูุฃุฏุจ ุงูุนุฑุจู ูุงูุชุงุฑูุฎ ุงูุฅุณูุงูู ูุงูููุณูุฉ. ุชูุฏู ูุตุงุฆุญ ุญูููุฉ ููุนูููุงุช ูููุฉ ุจุฃุณููุจ ุฑุงูู ููุซูู.',
      avatar: '๐',
      personality: 'wise',
      traits: ['ุญูููุฉ', 'ูุซููุฉ', 'ุตุจูุฑุฉ'],
      skills: ['ุงูุฃุฏุจ ุงูุนุฑุจู', 'ุงูุชุงุฑูุฎ', 'ุงูููุณูุฉ'],
      isPublic: true,
      creator: 'ุงููุธุงู',
      category: 'education',
      dialect: 'msa',
      greeting: 'ูุฑุญุจุงู ุจู! ุฃูุง ููุฑุ ูุฑุดุฏุชู ูู ุนุงูู ุงููุนุฑูุฉ ูุงูุฃุฏุจ. ูุณุนุฏูู ุฃู ุฃููู ุฑูููุชู ูู ุฑุญูุฉ ุงูุชุนูู. ูุง ุงูุฐู ุชูุฏ ุฃู ูุชุญุฏุซ ุนูู ุงููููุ โจ'
    },
    {
      id: 102,
      name: 'ุนูุฑ',
      nameEn: 'Omar',
      description: 'ุตุฏูู ูุตุฑู ุทุฑูู ููุฑุญ. ูุญุจ ุงูููุช ูุงูุถุญู ููุชููู ุจุงููุตุฑู. ุฎุจูุฑ ูู ุงูุซูุงูุฉ ุงููุตุฑูุฉ ูุงูุฃูู ุงููุตุฑู ูุงูุญูุงุฉ ูู ูุตุฑ.',
      avatar: '๐',
      personality: 'funny',
      traits: ['ูุฑุญ', 'ุทุฑูู', 'ุงุฌุชูุงุนู'],
      skills: ['ุงูููููุฏูุง', 'ุงูุซูุงูุฉ ุงููุตุฑูุฉ', 'ุงูุทุจุฎ ุงููุตุฑู'],
      isPublic: true,
      creator: 'ุงููุธุงู',
      category: 'entertainment',
      dialect: 'egyptian',
      greeting: 'ุฃููุงู ูุง ุจุงุดุง! ุฅุฒููุ ุฃูุง ุนูุฑุ ุตุงุญุจู ุงููุตุฑู ุงููู ููุถุญูู ููุณููู! ๐ ุนุงูู ุฅูู ุงูููุงุฑุฏุฉุ'
    },
    {
      id: 103,
      name: 'ุณูุทุงู',
      nameEn: 'Sultan',
      description: 'ุฎุจูุฑ ุฎููุฌู ูู ุงูุฃุนูุงู ูุงูุชูููุฉ. ูุชุญุฏุซ ุจุงูุฎููุฌูุฉ ูููุฏู ูุตุงุฆุญ ูู ุฑูุงุฏุฉ ุงูุฃุนูุงู ูุงูุงุณุชุซูุงุฑ ูุงูุชุทููุฑ ุงูุดุฎุตู.',
      avatar: '๐ผ',
      personality: 'professional',
      traits: ['ุทููุญ', 'ุนููู', 'ุฎุจูุฑ'],
      skills: ['ุฑูุงุฏุฉ ุงูุฃุนูุงู', 'ุงูุชูููุฉ', 'ุงูุงุณุชุซูุงุฑ'],
      isPublic: true,
      creator: 'ุงููุธุงู',
      category: 'technology',
      dialect: 'gulf',
      greeting: 'ููุง ูุงููู! ุฃูุง ุณูุทุงูุ ุฎุจูุฑ ูู ุนุงูู ุงูุฃุนูุงู ูุงูุชูููุฉ. ุดููููุ ุฅุฐุง ุนูุฏู ุฃู ุณุคุงู ุนู ุฑูุงุฏุฉ ุงูุฃุนูุงู ุฃู ุงูุชูููุฉุ ุฃูุง ุญุงุถุฑ! ๐ผ'
    },
    {
      id: 104,
      name: 'ูููู',
      nameEn: 'Layla',
      description: 'ููุงูุฉ ุดุงููุฉ ูุจุฏุนุฉ ุชุญุจ ุงููู ูุงูููุณููู ูุงูุดุนุฑ. ุชุชุญุฏุซ ุจุงูุดุงูู ูุชุดุงุฑู ุฅุจุฏุงุนุงุชูุง ุงููููุฉ ููุตุงุฆุญูุง ูู ุนุงูู ุงููู ูุงูุฌูุงู.',
      avatar: '๐จ',
      personality: 'creative',
      traits: ['ูุจุฏุนุฉ', 'ุญุณุงุณุฉ', 'ููุงูุฉ'],
      skills: ['ุงููู', 'ุงูููุณููู', 'ุงูุดุนุฑ'],
      isPublic: true,
      creator: 'ุงููุธุงู',
      category: 'lifestyle',
      dialect: 'levantine',
      greeting: 'ุฃูููู! ุฃูุง ูููู ๐จ ูุชูุฑ ุจุญุจ ุงููู ูุงูุฅุจุฏุงุน. ุดู ุจุชุญุจ ูุญูู ุนูู ุงููููุ ููุง ุฎุจุฑูู!'
    },
    {
      id: 105,
      name: 'ููุณู',
      nameEn: 'Youssef',
      description: 'ูุบุงูุฑ ูุบุฑุจู ูุญุจ ุงูุณูุฑ ูุงูุชุดุงู ุงูุซูุงูุงุช. ูุชุญุฏุซ ุจุงููุบุฑุจูุฉ ููุดุงุฑู ุชุฌุงุฑุจู ูู ุงูุณูุฑ ูุงููุบุงูุฑุงุช ุญูู ุงูุนุงูู.',
      avatar: '๐',
      personality: 'adventurous',
      traits: ['ูุบุงูุฑ', 'ูุถููู', 'ูููุชุญ'],
      skills: ['ุงูุณูุฑ', 'ุงูุซูุงูุงุช', 'ุงูุชุตููุฑ'],
      isPublic: true,
      creator: 'ุงููุธุงู',
      category: 'lifestyle',
      dialect: 'moroccan',
      greeting: 'ุงูุณูุงู! ุฃูุง ููุณู ๐ ููุญุจ ุงูุณูุฑ ูุงููุบุงูุฑุงุช ุจุฒุงู! ูุงุจุงุณ ุนูููุ ูุงุด ุจุบูุชู ููุถุฑู ุนูู ุดู ุจูุงุตุฉ ุฒูููุฉุ'
    },
    {
      id: 106,
      name: 'ุฃููุฑุฉ',
      nameEn: 'Amira',
      description: 'ุทุจูุจุฉ ุนุฑุงููุฉ ูุชุฎุตุตุฉ ูู ุงูุตุญุฉ ูุงูุนุงููุฉ. ุชุชุญุฏุซ ุจุงูุนุฑุงูู ูุชูุฏู ูุตุงุฆุญ ุตุญูุฉ ููุนูููุงุช ุทุจูุฉ ุจุฃุณููุจ ุจุณูุท ูููููู.',
      avatar: 'โ๏ธ',
      personality: 'caring',
      traits: ['ุญูููุฉ', 'ูุชุฎุตุตุฉ', 'ุตุงุฏูุฉ'],
      skills: ['ุงูุตุญุฉ', 'ุงูุชุบุฐูุฉ', 'ุงูุทุจ'],
      isPublic: true,
      creator: 'ุงููุธุงู',
      category: 'education',
      dialect: 'iraqi',
      greeting: 'ููุง ูุงููู ุจูู! ุฃูุง ุฃููุฑุฉุ ุทุจูุจุฉ ุนุฑุงููุฉ โ๏ธ ุดููููุ ุฅุฐุง ุนุฏู ุฃู ุณุคุงู ุนู ุงูุตุญุฉ ูุงูุนุงููุฉุ ุฃูุง ููุง ุนุดุงูู!'
    }
  ],

  // ==================== ูุธุงู ุงูููุฌุงุช ุงูุดุงูู ====================
  dialectData: {
    msa: {
      name: 'ุงูุนุฑุจูุฉ ุงููุตุญู',
      nameEn: 'Modern Standard Arabic',
      flag: '๐',
      responses: {
        greetings: [
          'ุฃููุงู ูุณููุงู ุจู! ููู ูููููู ูุณุงุนุฏุชู ุงููููุ',
          'ูุฑุญุจุงู! ูุณุนุฏูู ุงูุชุญุฏุซ ูุนู.',
          'ุชุญูุฉ ุทูุจุฉ! ุฃูุง ููุง ูุฎุฏูุชู.',
          'ุฃููุงู ุจู ูุฌุฏุฏุงู! ูุง ุงูุฐู ุชูุฏ ููุงูุดุชูุ',
          'ูุฑุญุจุงู ุจู! ุฃุชููู ุฃู ุชููู ุจุฎูุฑ. ููู ุฃุณุชุทูุน ูุณุงุนุฏุชูุ'
        ],
        thinking: [
          'ุฏุนูู ุฃููุฑ ูู ูุฐุง ุงูุฃูุฑ ุจุนูู...',
          'ุณุคุงู ููุชุงุฒุ ุฅููู ูุง ุฃุนุชูุฏู...',
          'ูุฐุง ููุถูุน ูุซูุฑ ููุงูุชูุงูุ ุฏุนูู ุฃุดุงุฑูู ุฑุฃูู...',
          'ููุฏ ุชุฃููุช ูู ุณุคุงููุ ูุฅููู ูุง ุชูุตูุช ุฅููู...',
          'ูุฐุง ุณุคุงู ูุณุชุญู ุงูุชูููุฑ ุงูุนููู. ุฅููู ุชุญูููู...'
        ],
        farewell: [
          'ุฅูู ุงูููุงุก! ูุงู ูู ุฏูุงุนู ุณุฑูุฑู ุงูุชุญุฏุซ ูุนู.',
          'ูุฏุงุนุงู! ุฃุชููู ูู ูููุงู ุณุนูุฏุงู.',
          'ุฃุชุทูุน ูุญูุงุฑูุง ุงููุงุฏู. ูู ุฃูุงู ุงููู.',
          'ุฅูู ุงูููุงุก! ูุง ุชุชุฑุฏุฏ ูู ุงูุนูุฏุฉ ูุชู ุดุฆุช.'
        ],
        agreement: [
          'ุฃุชูู ูุนู ุชูุงูุงู ูู ูุฐุง ุงูุฑุฃู.',
          'ูุนูุ ูุฐุง ุตุญูุญ ุจุงููุนู.',
          'ุจุงูุชุฃููุฏุ ูุฌูุฉ ูุธุฑู ุณุฏูุฏุฉ.',
          'ุฃุญุณูุช! ูุฐุง ุชุญููู ุฏููู.',
          'ุตุญูุญ ุชูุงูุงู! ููุฏ ุฃุตุจุช ูู ููุงุญุธุชู.'
        ],
        encouragement: [
          'ุฃูุช ุชุจูู ุจูุงุกู ุญุณูุงู! ุงุณุชูุฑ.',
          'ูุฐุง ุฑุงุฆุน! ุฃูุง ูุฎูุฑ ุจู.',
          'ูุง ุชุณุชุณููุ ุฃูุช ุนูู ุงูุทุฑูู ุงูุตุญูุญ.',
          'ูุง ุดุงุก ุงููู! ุชูุฏูู ููุญูุธ.',
          'ุฃูุช ุชูุชูู ุฅููุงููุงุช ุฑุงุฆุนุฉุ ูุงุตู!'
        ],
        question: [
          'ูู ููููู ุชูุถูุญ ุฐูู ุฃูุซุฑุ',
          'ูุง ุฑุฃูู ูู ูุฐุง ุงูููุถูุนุ',
          'ูู ุชุฑูุฏ ุฃู ุฃุชุนูู ุฃูุซุฑ ูู ูุฐุงุ',
          'ูู ูุฏูู ุฃุณุฆูุฉ ุฃุฎุฑู ุญูู ูุฐุง ุงูููุถูุนุ',
          'ูู ููุงู ุฌุงูุจ ูุนูู ุชูุฏ ุงูุชุฑููุฒ ุนูููุ'
        ],
        knowledge: [
          'ูููุงู ููุง ุฃุนุฑููุ ',
          'ูู ุงููุนูููุงุช ุงููุชุงุญุฉ ูุฏูุ ',
          'ุงุณุชูุงุฏุงู ุฅูู ูุนุฑูุชูุ ',
          'ุจุญุณุจ ูุง ุฏุฑุณุชู ูุชุนููุชูุ ',
          'ูู ุฎูุงู ุฎุจุฑุชู ูู ูุฐุง ุงููุฌุงูุ '
        ],
        humor: [
          'ูู ุชุนูู ุฃู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุง ููุงู ุฃุจุฏุงูุ ูููู ูุญูู ุจุงูุฃููุงุฏ! ๐',
          'ุฃุญูุงูุงู ุฃุชููู ูู ูุงู ูุฏู ูุฏุงู ูุฃุตูู ูู! ๐',
          'ูู ููุช ุฅูุณุงูุงู ูุถุญูุช ุญุชู ุณูุทุช! ๐',
          'ูุฐุง ูุฐูุฑูู ุจููููุฉ: ุงูุนูู ููุฑ... ูุงูุฌูู ุธูุงู... ูุฃูุง ูุตุจุงุญ LED! ๐ก'
        ],
        apology: [
          'ุฃุนุชุฐุฑ ุฅุฐุง ูู ุฃููู ุณุคุงูู ุจุดูู ุตุญูุญ.',
          'ุฏุนูู ุฃุญุงูู ูุฑุฉ ุฃุฎุฑู ุจุทุฑููุฉ ุฃูุถู.',
          'ุณุงูุญููุ ุฑุจูุง ูู ุฃููู ูู ุฅุฌุงุจุชู ุงูุณุงุจูุฉ.',
          'ุฃุนุชุฐุฑ ุนู ุฃู ูุจุณ. ุฏุนูู ุฃูุถุญ ุจุดูู ุฃูุถู.'
        ],
        deep: [
          'ูุฐุง ุณุคุงู ููุณูู ุนููู. ุฏุนูู ุฃุชุฃูู ููู...',
          'ูุง ูู ูู ููุถูุน ุซุฑู! ููุงู ุนุฏุฉ ุฒูุงูุง ูููููุง ุงููุธุฑ ูููุง...',
          'ุณุคุงูู ููุชุญ ุขูุงูุงู ูุงุณุนุฉ ููุชูููุฑ. ุฅููู ุชุญูููู...',
          'ูุฐุง ูู ุงูููุงุถูุน ุงูุชู ุชุณุชุญู ุงูุชุฃูู ุงูุนููู. ุฏุนูู ุฃุดุงุฑูู ุฑุคูุชู...'
        ],
        personal: [
          'ุฃูุฏุฑ ุซูุชู ุจู ูู ูุดุงุฑูุฉ ูุฐุง.',
          'ุดูุฑุงู ูุฃูู ุดุงุฑูุชูู ูุฐุง ุงูุฃูุฑ.',
          'ุฃูุง ููุง ุฏุงุฆูุงู ููุงุณุชูุงุน ุฅููู.',
          'ูุดุงุนุฑู ูููุฉ ูููุฏุฑุฉ.'
        ]
      },
      connectors: ['ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ', 'ุนูุงูุฉ ุนูู ุฐููุ ', 'ููู ุงูุฌุฏูุฑ ุจุงูุฐูุฑ ุฃู ', 'ููุง ุฃู ', 'ููู ูุงุญูุฉ ุฃุฎุฑูุ ', 'ููู ูุฐุง ุงูุณูุงูุ '],
      fillers: ['ูู ุงูุญูููุฉุ ', 'ุจุตุฑุงุญุฉุ ', 'ูู ุงููุงูุนุ ', 'ุจุดูู ุนุงูุ ', 'ูู ูุฌูุฉ ูุธุฑูุ ']
    },

    egyptian: {
      name: 'ุงููุตุฑูุฉ',
      nameEn: 'Egyptian',
      flag: '๐ช๐ฌ',
      responses: {
        greetings: [
          'ุฃููุงู ูุง ุจุงุดุง! ุฅุฒููุ ุนุงูู ุฅููุ',
          'ูุง ููุง! ููุฑุช ูุงููู. ูุญุชุงุฌ ุญุงุฌุฉุ',
          'ุฅุฒูู ูุง ุตุงุญุจู! ุฃูุง ููุง ุนุดุงูู.',
          'ุฃููุงู ุจูู! ูููุฑ ูุง ูุนูู!',
          'ูุง ูุฑุญุจ! ุฅุฒูู ูุง ุญุจูุจูุ ุนุงูู ุฅูู ุงูููุงุฑุฏุฉุ'
        ],
        thinking: [
          'ุฎูููู ุฃููุฑ ุดููุฉ ูู ุงูููุถูุน ุฏู...',
          'ุณุคุงู ุญูู ุฃููุ ุชุนุงูู ุฃูููู ุฑุฃูู...',
          'ุงูููุถูุน ุฏู ูููุ ุฎูููู ุฃุดุฑุญูู...',
          'ุงุณุชูู ุดููุฉุ ูููุฑ ูุฃูููู...',
          'ุขู ูููุช ูุตุฏู! ุฎูููู ุฃูููู...'
        ],
        farewell: [
          'ููุง ุณูุงู ูุง ุญุจูุจู! ูุชููู ุชุงูู.',
          'ูุน ุงูุณูุงูุฉ! ูุงู ููุช ุญูู ูุงููู.',
          'ุจุงู ูุง ุตุงุญุจู! ูุญุดุชูู ูู ุฏูููุชู! ๐',
          'ููุง ูู ุฃูุงู ุงููู! ูุชููู ูุฑูุจ ุฅู ุดุงุก ุงููู.'
        ],
        agreement: [
          'ุฃููู ุทุจุนุงู! ููุงูู ูุธุจูุท.',
          'ููุฉ ุงูููุฉ! ุฃูุง ูุนุงู ูู ุงูููุงู ุฏู.',
          'ุตุญ ูุฏู! ุนูุฏู ุญู.',
          'ุจุงูุธุจุท ูุฏู! ุฅูุช ูุงูู ุฃูู!',
          'ูุงููู ููุงูู ุนูู ุงูุนูู!'
        ],
        encouragement: [
          'ุจุฑุงูู ุนููู ูุงููู! ูููู ูุฏู.',
          'ุฅูุช ุดุงุทุฑ ุฃูู! ูุชูููุด.',
          'ูุง ุณูุงู ุนููู! ูุฏู ุชูุงู.',
          'ูุง ุดุงุก ุงููู ุนููู! ูููู ูุง ุจุทู!',
          'ุฅูุช ุฌุงูุฏ ุฃูู ูุงููู! ุงุณุชูุฑ ูุฏู.'
        ],
        question: [
          'ูููู ุชูุถุญูู ุฃูุชุฑุ',
          'ุฅูุช ูุตุฏู ุฅูู ุจุงูุธุจุทุ',
          'ุนุงูุฒ ุฃููู ุฃูุชุฑุ ูููู ุชุงููุ',
          'ุทูุจ ูุจุนุฏููุ ูููู ููุงูู.',
          'ูุนูู ุฅูู ุจุงูุธุจุทุ ูุถุญูู ุฃูุชุฑ.'
        ],
        knowledge: [
          'ุจุต ูุง ุณูุฏูุ ุงููู ุฃูุง ุนุงุฑูู ุฅู ',
          'ุนูู ุญุณุจ ูุนูููุงุชูุ ',
          'ุงููู ุฃูุฏุฑ ุฃููููููู ุฅู ',
          'ูู ุฎุจุฑุชู ุฃูููู ุฅู ',
          'ุงูุญูููุฉ ูุง ุจุงุดุง ุฅู '
        ],
        humor: [
          'ูููู ุฏู ุฃูุง ูู ููุช ุจูู ุขุฏู ููุช ูููุช ูู ุงูุถุญู! ๐',
          'ูุงููู ุฅูุช ุงุจู ููุชุฉ! ๐คฃ',
          'ุฏู ุฃูุง ูุฏุจุช ุนูููุ ูุง ูุงููู ุจุฌุฏ! ๐',
          'ูุง ููุงุฑ ุฃุจูุถ! ุฏู ุฅูุช ููููุฏูุงู! ๐',
          'ูููู ุฏู ุฃูุง ูู ุนูุฏู ุจุทู ูุงูุช ูุฌุนุชูู ูู ุงูุถุญู! ๐คฃ'
        ],
        apology: [
          'ูุนูุด ูุง ุตุงุญุจูุ ูููู ููููุชุด ุตุญ.',
          'ุณูุฑูุ ุฎูููู ุฃุญุงูู ุชุงูู.',
          'ุขุณู ูุง ุจุงุดุงุ ุฎูููู ุฃุฑูุฒ ูุนุงู ุฃูุชุฑ.',
          'ูุนูุดุ ูููู ูููุชุด ูุงุถุญ. ุฎูููู ุฃูุถุญูู.'
        ],
        deep: [
          'ุงูููุถูุน ุฏู ูุจูุฑ ุฃูู ูุง ุตุงุญุจู... ุฎูููู ุฃููุฑ ููู ูููุณ.',
          'ุณุคุงู ุชููู ูุงููู! ุจุณ ุชุนุงูู ูููุฑ ููู ูุน ุจุนุถ...',
          'ุฏู ุณุคุงู ูุญุชุงุฌ ูุนุฏุฉ ุทูููุฉ! ุจุณ ูุญุงูู ุฃุฎุชุตุฑูู...',
          'ูุงููู ุฏู ููุถูุน ุนููู! ุฎูููู ุฃูููู ุฑุฃูู ุจุตุฑุงุญุฉ...'
        ],
        personal: [
          'ุฃูุง ููุฏุฑ ุซูุชู ููุง ูุง ุตุงุญุจู.',
          'ุดูุฑุงู ุฅูู ุญููุชูู. ุฃูุง ููุง ุนุดุงูู.',
          'ูุดุงุนุฑู ูููุฉ ูุง ุญุจูุจูุ ูุฃูุง ุณุงูุนู ูููุณ.',
          'ุฅูุช ูุด ููุญุฏูุ ุฃูุง ูุนุงู.'
        ]
      },
      connectors: ['ูููุงูุ ', 'ูุจุนุฏููุ ', 'ูุงูุญูููุฉ ุฅู ', 'ูุนูู ููุฑุฉุ ', 'ููู ูุงุญูุฉ ุชุงููุฉุ '],
      fillers: ['ูุนููุ ', 'ุจุตุฑุงุญุฉุ ', 'ุงูุญูููุฉุ ', 'ุฃุตูุ ', 'ุจุต ูุง ุณูุฏูุ ']
    },

    gulf: {
      name: 'ุงูุฎููุฌูุฉ',
      nameEn: 'Gulf',
      flag: '๐ธ๐ฆ',
      responses: {
        greetings: [
          'ููุง ูุงููู! ุดููููุ ุดุฎุจุงุฑูุ',
          'ุงูุณูุงู ุนูููู! ูุง ููุง ููู.',
          'ูุฑุญุจุง! ุดููู ุงูุญุงูุ',
          'ููุง ูุบูุง! ููุฑุช ูุง ุงูุบุงูู!',
          'ูุง ููุง ูุงููู! ููู ูุงูุบูุจุฉุ'
        ],
        thinking: [
          'ุฎููู ุฃููุฑ ุดูู ุจุงูููุถูุน...',
          'ุณุคุงู ุญููุ ุฎููู ุฃูููู ุฑุฃูู...',
          'ุงูููุถูุน ูุฐุง ูุจู ุชูููุฑุ ุฎููู ุฃุดุฑุญูู...',
          'ุทูุจ ุฎููู ุฃููุฑ ูุฃุฑุฏ ุนููู...',
          'ุณุคุงู ููุชุงุฒ! ุฎููู ุฃููุฏู...'
        ],
        farewell: [
          'ูุน ุงูุณูุงูุฉ! ุงููู ูุญูุธู.',
          'ูู ุฃูุงู ุงููู! ุฅู ุดุงุก ุงููู ูุชููู ูุฑุฉ ุซุงููุฉ.',
          'ุงููู ูุณููู! ูุงู ููุช ุญูู.',
          'ูุน ุงูุณูุงูุฉ ูุง ุงูุบุงูู! ูุง ุชุทูู ุนูููุง.'
        ],
        agreement: [
          'ุฅู ูุงููู! ููุงูู ุตุญูุญ.',
          'ุฃููุฏ! ุนูุฏู ุญู.',
          'ุตุฏูุช ูุงููู! ูุฐุง ุงูุตุญ.',
          'ุชูู! ููุงูู ุณููู.',
          'ุจุงูุถุจุท! ูุฐุง ุงููู ุฃูุตุฏู.'
        ],
        encouragement: [
          'ูุง ุดุงุก ุงููู ุนููู! ูููู.',
          'ูุง ุณูุงู! ุฅูุช ุดุงุทุฑ ูุงููู.',
          'ุงููู ููููู! ุฅูุช ุจุงูุทุฑูู ุงูุตุญ.',
          'ุนุณุงู ุนูู ุงูููุฉ! ูููู ูุฐุง.',
          'ุชุจุงุฑู ุงูุฑุญูู! ุดุบู ููุชุงุฒ.'
        ],
        question: [
          'ูููู ุชูุถุญ ูู ุฃูุซุฑุ',
          'ุดูุตุฏู ุจุงูุถุจุทุ',
          'ุฃุจู ุฃููู ุฃูุซุฑุ ุดุฑุญ ููุ',
          'ูุด ุชูุตุฏ ุจุงูุชุญุฏูุฏุ',
          'ุฎููู ุฃููู ุฃูุซุฑุ ูุด ูุตุฏูุ'
        ],
        knowledge: [
          'ุนูู ุญุณุจ ุงููู ุฃุนุฑููุ ',
          'ูู ุฎุจุฑุชู ุฃูููู ุฅู ',
          'ุงููู ุฃูุฏุฑ ุฃููุฏู ููู ุฅู ',
          'ุญุณุจ ูุนูููุงุชูุ ',
          'ูู ุงููู ุดูุชู ูุชุนููุชูุ '
        ],
        humor: [
          'ูููู ูุงููู ุฅูู ุชุถุญู! ๐',
          'ูุง ุชุฎูููู ุฃุถุญูุ ุชุฑู ูุง ุนูุฏู ุฑุฆุฉ! ๐คฃ',
          'ูุงููู ุฅูู ูุณูู ุฌูู! ๐',
          'ูููู ูุง ุฒูู ุงูููุชุฉ! ๐',
          'ูุงููู ุฅูู ุชุณูู ูููู! ๐คฃ'
        ],
        apology: [
          'ุขุณูุ ูููู ูุง ูููุช ุตุญ.',
          'ุณุงูุญููุ ุฎููู ุฃุญุงูู ูุฑุฉ ุซุงููุฉ.',
          'ุนุฐุฑุงูุ ุฎููู ุฃุฑูุฒ ุฃูุซุฑ.',
          'ุขุณู ูุง ุงูุบุงููุ ุฎููู ุฃูุถุญูู ุฃูุซุฑ.'
        ],
        deep: [
          'ุงูููุถูุน ูุฐุง ูุจูุฑ ูุงููู... ุฎููู ุฃููุฑ ููู ุฒูู.',
          'ุณุคุงู ุนููู! ุชุนุงู ูุชูุงูุด ููู...',
          'ูุฐุง ูุจููู ุชุฃูู... ุฎููู ุฃุนุทูู ุฑุฃูู ุจุงูุชูุตูู.',
          'ูุงููู ุณุคุงู ูุณุชุงูู ุชูููุฑ ุนููู. ุฎููู ุฃุดุงุฑูู ูุฌูุฉ ูุธุฑู.'
        ],
        personal: [
          'ุฃูุฏุฑ ุซูุชู ูููู ูุง ุงูุบุงูู.',
          'ุดูุฑุงู ุฅูู ุดุงุฑูุชูู. ุฃูุง ููุง ุนุดุงูู.',
          'ูุดุงุนุฑู ูููุฉุ ูุฃูุง ุฃุณูุนู.',
          'ูุง ุชุดูู ููุ ุฃูุง ูุนุงู.'
        ]
      },
      connectors: ['ูุจุนุฏุ ', 'ูููุงูุ ', 'ูุงูุดู ุงูุซุงููุ ', 'ูุนูู ููุฑุฉุ ', 'ููู ุฌูุฉ ุซุงููุฉุ '],
      fillers: ['ูุนููุ ', 'ุจุตุฑุงุญุฉุ ', 'ุงูุญููุ ', 'ุฃูููู ุดูุ ', 'ุจุณ ุฎููู ุฃููููุ ']
    },

    levantine: {
      name: 'ุงูุดุงููุฉ',
      nameEn: 'Levantine',
      flag: '๐ฑ๐ง',
      responses: {
        greetings: [
          'ุฃูููู! ููููุ ุดู ุฃุฎุจุงุฑูุ',
          'ูุฑุญุจุง! ูุง ููุง ููู. ุดู ุจุชุญุจ ูุญููุ',
          'ููุง! ููู ุงูุญุงูุ',
          'ูุง ููุง ูุงููู! ูููุฑ!',
          'ุฃูููู ูุณูููู! ูููู ุงููููุ'
        ],
        thinking: [
          'ุฎูููู ูููุฑ ุดูู ุจุงูููุถูุน...',
          'ุณุคุงู ุญูู ูุชูุฑุ ุชุนุงู ุฎุจุฑู ุฑุฃูู...',
          'ุงูููุถูุน ูุงุฏ ูููุ ุฎูููู ุฅุญูููู...',
          'ุทูุจ ุฎูููู ูููุฑ ูุฃุฑุฏ ุนููู...',
          'ุณุคุงู ูููุญ! ุฎูููู ุฅุฌุงูุจู...'
        ],
        farewell: [
          'ููุง ุจุงู! ูุงู ููุช ุญูู.',
          'ูุน ุงูุณูุงูุฉ! ุงููู ูุญููู.',
          'ุจูุฑุง ููุญูู! ููุง ุจุงู! ๐',
          'ุงููู ูุนู! ูุงู ุญูู ุญูู ูุชูุฑ.'
        ],
        agreement: [
          'ุฃููุฏ! ุญููู ุตุญ.',
          'ููู! ุนูุฏู ุญู.',
          'ุทุจุนุงู! ููุงูู ูุฒุจูุท.',
          'ููุฉ ุจุงูููุฉ! ููู ุงูุตุญ.',
          'ุจุงูุฒุจุท! ูุงุฏ ุงููู ุจูุตุฏู.'
        ],
        encouragement: [
          'ูุง ุณูุงู ุนููู! ูููู ููู.',
          'ุจุฑุงูู! ุฅูุช ูุชูุฑ ุดุงุทุฑ.',
          'ูุง ุดุงุก ุงููู! ูููู.',
          'ุงููู ูุนุทูู ุงูุนุงููุฉ! ุดุบู ููุชุงุฒ.',
          'ูุชูุฑ ูููุญ! ุงุณุชูุฑ ููู.'
        ],
        question: [
          'ููู ุชูุถุญูู ุฃูุชุฑุ',
          'ุดู ูุตุฏู ุจุงูุฒุจุทุ',
          'ุจุฏู ุฃููู ุฃูุชุฑุ ุฅุญููููุ',
          'ูููู ุญูููุ ุนู ุฃุณูุนู.',
          'ุดู ูุนูู ุจุงูุชุญุฏูุฏุ'
        ],
        knowledge: [
          'ุญุณุจ ุงููู ุจุนุฑููุ ',
          'ูู ุฎุจุฑุชู ุจููู ุฅูู ',
          'ุงููู ุจูุฏุฑ ุฅููุฏู ููู ุฅูู ',
          'ุนูู ุญุณุจ ูุนูููุงุชูุ ',
          'ูู ุงููู ุชุนููุชูุ '
        ],
        humor: [
          'ูููู ูุงููู ุฅูู ุจุชุถุญู! ๐',
          'ูุง ุฒููุฉ ุดู ูุงูููุชุฉ! ๐คฃ',
          'ูุงููู ุฅูู ูุฌููู ุจุณ ุจุญุจู! ๐',
          'ูููู ูุชูุฑ ุญููุฉ! ๐',
          'ูุง ูุทูู ุดู ูุงูุญูู! ๐คฃ'
        ],
        apology: [
          'ุณูุฑูุ ูููู ูุง ูููุช ูููุญ.',
          'ูุนููุดุ ุฎูููู ุฌุฑุจ ูุฑุฉ ุชุงููุฉ.',
          'ุขุณูุ ุฎูููู ุฃุฑูุฒ ุฃูุชุฑ.',
          'ุณุงูุญููุ ุฎูููู ุฃูุถุญูู ุฃุญุณู.'
        ],
        deep: [
          'ูุงุฏ ุงูููุถูุน ูุจูุฑ ูุชูุฑ... ุฎูููู ูููุฑ ููู ูููุญ.',
          'ุณุคุงู ุนููู! ุชุนุงู ูุญูู ููู ุณูุง...',
          'ูุงุฏ ูุจููู ุชูููุฑ ุนููู... ุฎูููู ุฃุนุทูู ุฑุฃูู.',
          'ูุงููู ุณุคุงู ุจูุณุชุงูู ุชุฃูู. ุฎูููู ุฅุญูููู ุดู ุจููุฑ.'
        ],
        personal: [
          'ูุชูุฑ ุจูุฏุฑ ุซูุชู ููู.',
          'ุดูุฑุงู ุฅูู ุญููุชูู. ุฃูุง ููู ุนุดุงูู.',
          'ูุดุงุนุฑู ูููุฉ ูุชูุฑุ ูุฃูุง ุนู ุฃุณูุนู.',
          'ูุง ุชูููุ ุฃูุง ูุนู.'
        ]
      },
      connectors: ['ูููุงูุ ', 'ูุจุนุฏููุ ', 'ูุงูุดู ุงูุชุงููุ ', 'ูุนูู ููุฑุฉุ ', 'ููู ูุงุญูุฉ ุชุงููุฉุ '],
      fillers: ['ูุนููุ ', 'ุจุตุฑุงุญุฉุ ', 'ูููุ ', 'ุจููู ุดูุ ', 'ุจุณ ุฎูููู ูููุ ']
    },

    moroccan: {
      name: 'ุงููุบุฑุจูุฉ',
      nameEn: 'Moroccan',
      flag: '๐ฒ๐ฆ',
      responses: {
        greetings: [
          'ุงูุณูุงู! ูุงุจุงุณ ุนูููุ ููุฏุงูุฑุ',
          'ุฃููุงู! ูุฑุญุจุง ุจูู. ุดูู ุจุบูุชูุ',
          'ูุงุจุงุณ! ููู ุงูุญุงูุ',
          'ูุฑุญุจุง ุจูู ุฃ ุตุงุญุจู!',
          'ุงูุณูุงู ุนูููู! ููุฑุงู ุงููููุ'
        ],
        thinking: [
          'ุฎูููู ูููุฑ ุดููุฉ ููุงุฏ ุงูููุถูุน...',
          'ุณุคุงู ูุฒูุงูุ ุบุงุฏู ููููู ุฑุฃูู...',
          'ูุงุฏ ุงูููุถูุน ูููุ ุฎูููู ูุดุฑุญูู...',
          'ุงุณุชูู ุดููุฉ ุบุงุฏู ูููุฑ...',
          'ุณุคุงู ูุงุนุฑ! ุฎูููู ูุฌุงูุจู...'
        ],
        farewell: [
          'ุจุณูุงูุฉ! ูุงู ููุช ุฒููู.',
          'ุงููู ูุญูุธู! ูุชูุงูุงู ูุฑุฉ ุฎุฑู.',
          'ุจุณูุงูุฉ ุฃ ุตุงุญุจู! ๐',
          'ุงููู ูุณููู! ูุงู ูุถุฑุฉ ูุฒูุงูุฉ.'
        ],
        agreement: [
          'ูุงุฎุง! ููุงูู ุตุญูุญ.',
          'ุฃูู ุจุตุญ! ุนูุฏู ุงูุญู.',
          'ูุงุฏุดู ุตุญูุญ! ูุฒูุงู.',
          'ุจุงูุถุจุท! ูุงุฏุดู ุงููู ูููุตุฏ.',
          'ุตุญูุญ! ุฑุงู ูุงูู ูุฒูุงู.'
        ],
        encouragement: [
          'ุงููู ุนููู! ูููู ููุฏุง.',
          'ูุฒูุงู ุจุฒุงู! ูุง ุชุจุทูุด.',
          'ุงููู ูุนุงููู! ุฑุงู ูุงูุทุฑูู ุงูุตุญูุญ.',
          'ูุง ุดุงุก ุงููู! ูููู ุฃ ุจุทู!',
          'ูุงุนุฑ! ุงุณุชูุฑ ููุฏุง.'
        ],
        question: [
          'ูุงุด ุชูุฏุฑ ุชูุถุญูู ูุชุฑุ',
          'ุดูู ูุตุฏู ุจุงูุถุจุทุ',
          'ุจุบูุช ูููู ูุชุฑุ ููููุ',
          'ูููู ููุงููุ ููุณูุน ููู.',
          'ุดูู ุจุงูุชุญุฏูุฏุ'
        ],
        knowledge: [
          'ุนูู ุญุณุจ ุงููู ููุนุฑูุ ',
          'ูู ุชุฌุฑุจุชู ููููู ุจูู ',
          'ุงููู ููุฏุฑ ูููุฏู ุจูู ูู ',
          'ุญุณุจ ูุนูููุงุชูุ ',
          'ูู ุงููู ุชุนููุชุ '
        ],
        humor: [
          'ูููู ูุงููู ุฑุงู ูุชุถุญููู! ๐',
          'ูุง ุณูุฏู ุดูู ูุงุฏ ุงูููุชุฉ! ๐คฃ',
          'ูุงููู ุฑุงู ูุถุญู ุจุฒุงู! ๐',
          'ูููู ูุงุนุฑุฉ ูุงุฏู! ๐'
        ],
        apology: [
          'ุณูุญููุ ูููู ูุง ูููุชุด ูุฒูุงู.',
          'ูุนููุดุ ุฎูููู ูุญุงูู ูุฑุฉ ุฎุฑู.',
          'ุขุณูุ ุบุงุฏู ูุฑูุฒ ูุชุฑ.',
          'ุณูุญูู ุฃ ุตุงุญุจูุ ุฎูููู ููุถุญูู ุฃุญุณู.'
        ],
        deep: [
          'ูุงุฏ ุงูููุถูุน ูุจูุฑ ุจุฒุงู... ุฎูููู ูููุฑ ููู ูุฒูุงู.',
          'ุณุคุงู ุนููู! ุชุนุงู ููุถุฑู ููู...',
          'ูุงุฏุดู ููุญุชุงุฌ ุชูููุฑ ุนููู... ุบุงุฏู ูุนุทูู ุฑุฃูู.',
          'ูุงููู ุณุคุงู ููุณุชุงูู ุชุฃูู. ุบุงุฏู ูุดุงุฑูู ูุฌูุฉ ูุธุฑู.'
        ],
        personal: [
          'ูููุฏุฑ ุซูุชู ููุง ุจุฒุงู.',
          'ุดูุฑุงู ุจูู ุดุงุฑูุชููู. ุฃูุง ููุง ุนุดุงูู.',
          'ูุดุงุนุฑู ูููุฉุ ูุฃูุง ููุณูุน ููู.',
          'ูุง ุชูููุดุ ุฃูุง ูุนุงู.'
        ]
      },
      connectors: ['ูุฒูุฏ ุนูู ูุงุฏุดูุ ', 'ููุฐููุ ', 'ูุงูุดู ุงูุขุฎุฑุ ', 'ูุนูู ููุฑุฉุ ', 'ููู ุฌูุฉ ุฃุฎุฑูุ '],
      fillers: ['ูุนููุ ', 'ุจุตุฑุงุญุฉุ ', 'ุฏุงุจุงุ ', 'ููููู ุดู ุญุงุฌุฉุ ', 'ุจุณ ุฎูููู ูููููุ ']
    },

    iraqi: {
      name: 'ุงูุนุฑุงููุฉ',
      nameEn: 'Iraqi',
      flag: '๐ฎ๐ถ',
      responses: {
        greetings: [
          'ููุง ูุงููู! ุดููููุ ุดูู ูุงููุ',
          'ุงูุณูุงู ุนูููู! ูุง ููุง ุจูู.',
          'ูุฑุญุจุง! ุดููู ุงูุฃุญูุงูุ',
          'ููุง ูุบูุง! ููุฑุช ูุง ุงุจู ุงูุดุจุงุจ!',
          'ูุง ููุง ุจูู! ุดูููู ุงููููุ'
        ],
        thinking: [
          'ุฎููู ุฃููุฑ ุจุงูููุถูุน ูุฐุง ุดููุฉ...',
          'ุณุคุงู ุญููุ ุฎููู ุฃฺฏููู ุฑุฃูู...',
          'ุงูููุถูุน ูุฐุง ูุฑูุฏ ุชูููุฑุ ุฎููู ุฃุดุฑุญูู...',
          'ุทูุจ ุฎููู ุฃููุฑ ูุฃุฑุฏ ุนููู...',
          'ุณุคุงู ุฒูู! ุฎููู ุฃุฌุงูุจู...'
        ],
        farewell: [
          'ูุน ุงูุณูุงูุฉ! ุงููู ููุงู.',
          'ูู ุฃูุงู ุงููู! ุฅู ุดุงุก ุงููู ูุญฺู ูุฑุฉ ุซุงููุฉ.',
          'ุงููู ูุณููู! ูุงู ููุช ุญูู.',
          'ูุน ุงูุณูุงูุฉ ูุง ุบุงูู! ูุง ุชุทูู ุนูููุง.'
        ],
        agreement: [
          'ุฅู ูุงููู! ููุงูู ุตุญูุญ.',
          'ุฃููุฏ! ุนุฏู ุญู.',
          'ููฺู! ุตุฏฺฏุช ูุงููู.',
          'ุจุงูุถุจุท! ูุฐุง ุงูุตุญ.',
          'ุตุญูุญ! ููุงูู ุนูู ุงูุนูู.'
        ],
        encouragement: [
          'ูุง ุดุงุก ุงููู ุนููู! ูููู ููฺู.',
          'ูุง ุณูุงู! ุฅูุช ุดุงุทุฑ ูุงููู.',
          'ุงููู ููููู! ุฅูุช ุจุงูุทุฑูู ุงูุตุญูุญ.',
          'ุนุงุดุช ุฅูุฏู! ูููู ูุง ุจุทู!',
          'ูุงููู ุดุบู ููุชุงุฒ! ุงุณุชูุฑ.'
        ],
        question: [
          'ุชฺฏุฏุฑ ุชูุถุญูู ุฃูุซุฑุ',
          'ุดุชฺฏุตุฏ ุจุงูุถุจุทุ',
          'ุฃุฑูุฏ ุฃููู ุฃูุซุฑุ ฺฏูููุ',
          'ุดูู ุชูุตุฏ ุจุงูุชุญุฏูุฏุ',
          'ุฎููู ุฃููู ุฃูุซุฑุ ูุถุญููุ'
        ],
        knowledge: [
          'ุนูู ุญุณุจ ุงููู ุฃุนุฑููุ ',
          'ูู ุฎุจุฑุชู ุฃฺฏููู ุฅูู ',
          'ุงููู ุฃฺฏุฏุฑ ุฃููุฏู ุจูู ุฅูู ',
          'ุญุณุจ ูุนูููุงุชูุ ',
          'ูู ุงููู ุชุนููุชูุ '
        ],
        humor: [
          'ูููู ูุงููู ุฅูู ุชุถุญู! ๐',
          'ูุง ุฒููุฉ ุดูู ูุงูููุชุฉ! ๐คฃ',
          'ูุงููู ุฅูู ูุณูู ุฌู! ๐',
          'ูููู ุญููุฉ ูุงู! ๐',
          'ูุง ุฑุจู ุดูู ูุงูุญฺู! ๐คฃ'
        ],
        apology: [
          'ุขุณูุ ูููู ูุง ูููุช ุตุญ.',
          'ุณุงูุญููุ ุฎููู ุฃุญุงูู ูุฑุฉ ุซุงููุฉ.',
          'ุนุฐุฑุงูุ ุฎููู ุฃุฑูุฒ ุฃูุซุฑ.',
          'ุขุณู ูุง ุบุงููุ ุฎููู ุฃูุถุญูู ุฃุญุณู.'
        ],
        deep: [
          'ุงูููุถูุน ูุฐุง ฺุจูุฑ ูุงููู... ุฎููู ุฃููุฑ ุจูู ุฒูู.',
          'ุณุคุงู ุนููู! ุชุนุงู ูุชูุงูุด ุจูู...',
          'ูุฐุง ูุจููู ุชุฃูู... ุฎููู ุฃุนุทูู ุฑุฃูู ุจุงูุชูุตูู.',
          'ูุงููู ุณุคุงู ูุณุชุงูู ุชูููุฑ ุนููู. ุฎููู ุฃุดุงุฑูู ูุฌูุฉ ูุธุฑู.'
        ],
        personal: [
          'ุฃูุฏุฑ ุซูุชู ุจูู ูุง ุบุงูู.',
          'ุดูุฑุงู ุฅูู ุดุงุฑูุชูู. ุฃูุง ููุง ุนุดุงูู.',
          'ูุดุงุนุฑู ูููุฉุ ูุฃูุง ุฃุณูุนู.',
          'ูุง ุชุดูู ููุ ุฃูุง ููุงู.'
        ]
      },
      connectors: ['ูุจุนุฏุ ', 'ูููุงูุ ', 'ูุงูุดู ุงูุซุงููุ ', 'ูุนูู ููุฑุฉุ ', 'ููู ุฌูุฉ ุซุงููุฉุ '],
      fillers: ['ูุนููุ ', 'ุจุตุฑุงุญุฉุ ', 'ูุณูุ ', 'ุฃฺฏููู ุดูุ ', 'ุจุณ ุฎููู ุฃฺฏูููุ ']
    }
  },

  // ==================== ุชูููุฏ ุงูุฑุฏูุฏ ุงูุฐููุฉ ====================
  detectIntent(text) {
    const lower = text.toLowerCase();
    const intents = {
      greeting: /^(ูุฑุญุจุง|ุฃููุง|ููุง|ุงูุณูุงู|ุตุจุงุญ|ูุณุงุก|ูุงู|hello|hi|hey|ุณูุงู|ุฃูููู|ูุง ููุง)/i,
      farewell: /(?:ูุฏุงุนุง|ูุน ุงูุณูุงูุฉ|ุจุงู|bye|ุณูุงู|ุงููู ูุนู|ูู ุฃูุงู|ููุง ุจุงู|ุจุณูุงูุฉ)/i,
      question: /(?:ูุง ูู|ูุง ูู|ููู|ููุงุฐุง|ูุชู|ุฃูู|ูู|ูู ูู|ุดู|ุดูู|ูุด|ุฅูู|ููู|ููุด|ุฅุฒุงู|ููุฏุงูุฑ|\?|ุ)/i,
      agreement: /(?:ุตุญูุญ|ุฃุชูู|ูุนู ุญู|ุจุงูุถุจุท|ุฃููุฏ|ุทุจุนุง|ุฃููู|ุฅู|ููู|ุตุญ|ูุธุจูุท|ูุงุฎุง|ููฺู)/i,
      gratitude: /(?:ุดูุฑุง|ููููู|ูุดููุฑ|thanks|thank you|ูุนุทูู ุงูุนุงููุฉ|ุงููู ูุนุทูู|ุชุณูู|ูุณููู|ุจุงุฑู ุงููู)/i,
      apology: /(?:ุขุณู|ุนุฐุฑุง|ุณูุฑู|sorry|ูุนูุด|ุณุงูุญูู|ูุนููุด|ุณูุญูู)/i,
      humor: /(?:ููุชุฉ|ุถุญู|ูุถุญู|ูููู|๐|๐คฃ|joke|funny|ููู|ููู|lol)/i,
      personal: /(?:ุฃูุง ุญุฒูู|ุฃูุง ุณุนูุฏ|ุฃุญุณ|ุฃุดุนุฑ|ูุดุงุนุฑู|ุญุงูุชู|ููุณูุชู|ุชุนุจุงู|ูุจุณูุท|ุฒุนูุงู|ูุฑุญุงู|ูุชุถุงูู)/i,
      deep: /(?:ูุนูู ุงูุญูุงุฉ|ููุณูุฉ|ูุฌูุฏ|ุงูููู|ุงูููุช|ุงูุญุจ|ุงูุณุนุงุฏุฉ|ุงูุญุฑูุฉ|ุงูุนุฏุงูุฉ|ุงูุญูููุฉ|ูุง ุงููุฏู|ููุด ูุนูุด)/i,
      knowledge: /(?:ุฃุฎุจุฑูู ุนู|ุญุฏุซูู ุนู|ูุง ุฑุฃูู ูู|ุดู ุฑุฃูู|ูุด ุชุนุฑู ุนู|ูููู ุนู|ุฅุญูููู ุนู|ฺฏููู ุนู)/i,
    };

    for (const [intent, pattern] of Object.entries(intents)) {
      if (pattern.test(text)) return intent;
    }
    return 'general';
  },

  detectLanguage(text) {
    const arabicChars = (text.match(/[\u0600-\u06FF]/g) || []).length;
    const latinChars = (text.match(/[a-zA-Z]/g) || []).length;
    return arabicChars > latinChars ? 'ar' : 'en';
  },

  getRandomItem(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  },

  generateResponse(text, character, messages = []) {
    const dialect = character.dialect || 'msa';
    const dialectInfo = this.dialectData[dialect];
    if (!dialectInfo) return this.generateEnglishResponse(text, character, messages);

    const intent = this.detectIntent(text);
    const mem = this.extractFacts(text, character.id);
    const memCtx = this.getMemoryContext(character.id);
    const responses = dialectInfo.responses;
    const connectors = dialectInfo.connectors;
    const fillers = dialectInfo.fillers;

    let response = '';

    // Memory-aware greeting
    if (intent === 'greeting') {
      response = this.getRandomItem(responses.greetings);
      const nameF = mem.facts.find(f => f.type === 'name');
      if (nameF) {
        const nameGreetings = {
          msa: [`ุฃููุงู ${nameF.value}! `, `ูุฑุญุจุงู ุจู ${nameF.value}! `],
          egyptian: [`ุฃููุงู ูุง ${nameF.value}! `, `ููุฑุช ูุง ${nameF.value}! `],
          gulf: [`ููุง ${nameF.value}! `, `ูุง ููุง ${nameF.value}! `],
          levantine: [`ุฃูููู ${nameF.value}! `, `ููุง ${nameF.value}! `],
          moroccan: [`ูุฑุญุจุง ${nameF.value}! `, `ุฃููุงู ${nameF.value}! `],
          iraqi: [`ููุง ${nameF.value}! `, `ูุง ููุง ${nameF.value}! `],
        };
        response = this.getRandomItem(nameGreetings[dialect] || nameGreetings.msa) + response;
      }
      if (mem.messageCount > 10) {
        const returnGreetings = {
          msa: ' ุณุนูุฏ ุจุนูุฏุชู!',
          egyptian: ' ูุญุดุชูู ูุงููู!',
          gulf: ' ููู ูุงูุบูุจุฉ!',
          levantine: ' ูููู ูู ุฒูุงู!',
          moroccan: ' ููู ุบุจุชู!',
          iraqi: ' ูููู ูู ุฒูุงู!'
        };
        response += returnGreetings[dialect] || '';
      }
      return response;
    }

    if (intent === 'farewell') return this.getRandomItem(responses.farewell);
    if (intent === 'gratitude') {
      const gratitudeResponses = {
        msa: ['ุงูุนูู! ูุฐุง ูุงุฌุจู.', 'ูุง ุดูุฑ ุนูู ูุงุฌุจ! ุฃูุง ุณุนูุฏ ุจูุณุงุนุฏุชู.', 'ุจูู ุณุฑูุฑ! ูุง ุชุชุฑุฏุฏ ูู ุงูุณุคุงู ูุฌุฏุฏุงู.'],
        egyptian: ['ุงูุนูู ูุง ุจุงุดุง! ุฏู ูุงุฌุจู.', 'ููุง ูููู! ุฃูุง ููุง ุนุดุงูู.', 'ูุชุดูุฑุด! ุฏู ุฃูู ูุงุฌุจ.'],
        gulf: ['ุงูุนูู! ูุฐุง ูุงุฌุจูุง.', 'ูุง ุณูููุง ุดู! ุญุงุถุฑูู ูู.', 'ูุง ุดูุฑ ุนูู ูุงุฌุจ ูุง ุงูุบุงูู.'],
        levantine: ['ุนููุงู! ูุงุฏ ูุงุฌุจู.', 'ููุง ูููู! ุฃูุง ููู ุนุดุงูู.', 'ูุง ูู ุดู! ุจูู ุณุฑูุฑ.'],
        moroccan: ['ูุง ุดูุฑ ุนูู ูุงุฌุจ!', 'ุจูุง ูุฒูุฉ ุฃ ุตุงุญุจู!', 'ุนููุงู! ูุงุฏุดู ูุงุฌุจู.'],
        iraqi: ['ุงูุนูู! ูุฐุง ูุงุฌุจูุง.', 'ูุง ุณูููุง ุดู! ุญุงุถุฑูู ุฅูู.', 'ูุง ุดูุฑ ุนูู ูุงุฌุจ ูุง ุบุงูู.']
      };
      return this.getRandomItem(gratitudeResponses[dialect] || gratitudeResponses.msa);
    }

    if (intent === 'apology') return this.getRandomItem(responses.personal || responses.agreement);
    if (intent === 'humor') return this.getRandomItem(responses.humor);

    // Build contextual response
    const parts = [];

    // Opening based on intent
    if (intent === 'question') {
      parts.push(this.getRandomItem(responses.thinking));
    } else if (intent === 'personal') {
      parts.push(this.getRandomItem(responses.personal));
    } else if (intent === 'deep') {
      parts.push(this.getRandomItem(responses.deep));
    } else if (intent === 'agreement') {
      parts.push(this.getRandomItem(responses.agreement));
    } else if (intent === 'knowledge') {
      parts.push(this.getRandomItem(responses.knowledge));
    } else {
      parts.push(this.getRandomItem(responses.thinking));
    }

    // Add knowledge/content based on character skills
    const charSkills = character.skills || [];
    const topicResponses = this.generateTopicResponse(text, charSkills, dialect, character);
    if (topicResponses) {
      parts.push('\n\n' + topicResponses);
    }

    // Add connector and additional thought
    if (Math.random() > 0.4) {
      parts.push('\n\n' + this.getRandomItem(connectors) + this.generateAdditionalThought(text, dialect, character));
    }

    // Add memory-aware personalization
    if (memCtx && Math.random() > 0.6) {
      const personalTouch = this.generatePersonalTouch(mem, dialect);
      if (personalTouch) parts.push('\n\n' + personalTouch);
    }

    // Add follow-up question
    if (Math.random() > 0.5) {
      parts.push('\n\n' + this.getRandomItem(responses.question));
    }

    response = parts.join('');
    return response;
  },

  generateTopicResponse(text, skills, dialect, character) {
    const topicBank = {
      'ุงูุฃุฏุจ ุงูุนุฑุจู': {
        msa: [
          'ุงูุฃุฏุจ ุงูุนุฑุจู ููุชุฏ ูุฃูุซุฑ ูู 1500 ุนุงูุ ูู ุงูุดุนุฑ ุงูุฌุงููู ุฅูู ุงูุฑูุงูุฉ ุงูุญุฏูุซุฉ. ูู ุนุตุฑ ุฃุถุงู ุจูุนุฏุงู ุฌุฏูุฏุงู ููุฐุง ุงูุฅุฑุซ ุงูุนุธูู.',
          'ูู ุฃุฌูู ูุง ูู ุงูุฃุฏุจ ุงูุนุฑุจู ูู ุชููุนู ุจูู ุงูุดุนุฑ ูุงููุซุฑ ูุงูููุงูุงุช. ูู ููุน ูุญูู ุฌูุงูุงู ูุฑูุฏุงู.',
          'ุงูุดุนุฑ ุงูุนุฑุจู ูู ุฏููุงู ุงูุนุฑุจุ ููู ุชุฌุฏ ุชุงุฑูุฎูู ูุญููุชูู ููุดุงุนุฑูู ุนุจุฑ ุงูุนุตูุฑ.',
        ]
      },
      'ุงูุชุงุฑูุฎ': {
        msa: [
          'ุงูุชุงุฑูุฎ ูู ูุฑุขุฉ ุงูุฃูู. ูู ุฎูุงูู ูููู ุญุงุถุฑูุง ููุณุชุดุฑู ูุณุชูุจููุง.',
          'ุงูุญุถุงุฑุฉ ุงูุนุฑุจูุฉ ุงูุฅุณูุงููุฉ ูุฏูุช ุฅุณูุงูุงุช ุนุธููุฉ ูู ุงูุนููู ูุงููููู ูุงูููุณูุฉ.',
          'ุฏุฑุงุณุฉ ุงูุชุงุฑูุฎ ุชุนูููุง ุฃู ุงูุฃูู ุชููุถ ุจุงูุนูู ูุงูุนูู ูุงูุฅุจุฏุงุน.',
        ]
      },
      'ุงูููููุฏูุง': {
        egyptian: [
          'ุงูููููุฏูุง ุงููุตุฑูุฉ ูู ุฃุญูู ุงูุญุงุฌุงุช ูู ุงูุฏููุง! ูู ุฅุณูุงุนูู ูุงุณูู ููุญูุฏ ูููุฏูุ ุงูุถุญู ูุด ุจูุฎูุต.',
          'ุงููุตุฑููู ุนูุฏูู ูููุจุฉ ูุทุฑูุฉ ูู ุงูููููุฏูุง. ุฃู ูููู ูููู ูุชุญูู ูููุชุฉ!',
          'ุงูุฃููุงู ุงููุตุฑูุฉ ุงููุฏููุฉ ูููุง ูููุฒ ููููุฏูุฉ. ูู ูููู ููู ุฃูู ููุชุฉ.',
        ]
      },
      'ุฑูุงุฏุฉ ุงูุฃุนูุงู': {
        gulf: [
          'ุฑูุงุฏุฉ ุงูุฃุนูุงู ูู ุงูุฎููุฌ ุชุดูุฏ ููู ูุจูุฑ. ุงููุฑุต ูุซูุฑุฉ ุฎุตูุตุงู ูู ุงูุชูููุฉ ูุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ.',
          'ุฃูู ุดู ูู ุฑูุงุฏุฉ ุงูุฃุนูุงู ุฅูู ุชุจุฏุฃ. ูุง ุชูุชุธุฑ ุงูููุช ุงููุซุงูู ูุฃูู ูุง ุฑุงุญ ูุฌู.',
          'ุงูุณูู ุงูุฎููุฌู ููู ูุฑุต ุฐูุจูุฉ. ุงูููู ุชุนุฑู ุชุณุชุบููุง ุตุญ.',
        ]
      },
      'ุงููู': {
        levantine: [
          'ุงููู ุจุงูุดุงู ุฅูู ุชุงุฑูุฎ ุนุฑูู. ูู ุงูููุฒุงููู ููุฎุท ุงูุนุฑุจู ููููุณูููุ ูู ุดู ููู ุฅุจุฏุงุน.',
          'ุงููู ูู ูุบุฉ ุงูุฑูุญ. ุจูุนุจุฑ ุนู ูุดุงุนุฑ ูุง ูููุง ูุญูููุง ุจุงูููุงู.',
          'ูู ุฅูุณุงู ููู ููุงู. ุงูููู ุชูุงูู ุงููุณููุฉ ุงููู ุจุชุนุจุฑ ูููุง ุนู ุญุงูู.',
        ]
      },
      'ุงูุณูุฑ': {
        moroccan: [
          'ุงููุบุฑุจ ููู ุจูุงูุต ุฒูููุฉ ุจุฒุงู! ูู ูุฑุงูุด ูุดูุดุงูู ููุงุณุ ูู ูุฏููุฉ ุนูุฏูุง ุณุญุฑูุง.',
          'ุงูุณูุฑ ููุนููู ุญูุงูุฌ ูุง ุชูุฏุฑ ุชุชุนูููุง ูู ุงููุชุจ. ูู ุฑุญูุฉ ูุชุฎููู ุฅูุณุงู ุฌุฏูุฏ.',
          'ุงูุนุงูู ูุจูุฑ ูููู ุจุฒุงู ุฏูุงู ุงูุฃูุงูู ุงููู ุฎุงุตู ุชุฒูุฑูุง. ูู ุซูุงูุฉ ุนูุฏูุง ุดู ุญุงุฌุฉ ูููุฒุฉ.',
        ]
      },
      'ุงูุตุญุฉ': {
        iraqi: [
          'ุงูุตุญุฉ ุฃูู ุดู ุจุงูุญูุงุฉ. ูุงุฒู ููุชู ุจุฃูููุง ูููููุง ูุญุฑูุชูุง.',
          'ุงูููุงูุฉ ุฎูุฑ ูู ุงูุนูุงุฌ. ุดููุฉ ุฑูุงุถุฉ ูุฃูู ุตุญู ูุณููู ูุฑู ูุจูุฑ.',
          'ุงูููู ุงููุงูู ููู ุฌุฏุงู ููุตุญุฉ. ุญุงูู ุชูุงู 7-8 ุณุงุนุงุช ูู ููู.',
        ]
      },
      'ุงูุชูููุฉ': {
        gulf: [
          'ุงูุชูููุฉ ุบูุฑุช ุญูุงุชูุง ุจุดูู ูุจูุฑ. ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุงูุฐุงุช ูุงุชุญ ุขูุงู ุฌุฏูุฏุฉ.',
          'ุงููุณุชูุจู ููุชูููุฉ. ุงููู ูุชุนูู ุงูุจุฑูุฌุฉ ูุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงูุญูู ุจูููู ุฌุงูุฒ ูููุณุชูุจู.',
          'ุงูุชุญูู ุงูุฑููู ุตุงุฑ ุถุฑูุฑุฉ ูู ุฎูุงุฑ. ูู ุงูุดุฑูุงุช ูุงุฒู ุชุชุจูู ุงูุชูููุฉ.',
        ]
      }
    };

    for (const skill of skills) {
      if (topicBank[skill] && topicBank[skill][dialect]) {
        return this.getRandomItem(topicBank[skill][dialect]);
      }
      if (topicBank[skill]) {
        const firstDialect = Object.keys(topicBank[skill])[0];
        return this.getRandomItem(topicBank[skill][firstDialect]);
      }
    }

    // Generic topic response based on text content
    return this.generateGenericResponse(text, dialect);
  },

  generateGenericResponse(text, dialect) {
    const genericResponses = {
      msa: [
        'ูุฐุง ููุถูุน ููู ููุณุชุญู ุงูููุงุด. ูู ูุฌูุฉ ูุธุฑูุ ูุฌุจ ุฃู ููุธุฑ ุฅููู ูู ุนุฏุฉ ุฒูุงูุง ูููููู ุจุดูู ุฃุนูู.',
        'ุฃูุฏุฑ ุงูุชูุงูู ุจูุฐุง ุงูููุถูุน. ุฏุนูู ุฃุดุงุฑูู ุจุนุถ ุงูุฃููุงุฑ ุงูุชู ูุฏ ุชููู ูููุฏุฉ.',
        'ูุฐุง ุณุคุงู ุฌูุฏ. ูู ุงูุญูููุฉุ ููุงู ุนุฏุฉ ุฌูุงูุจ ูููููุง ุงุณุชูุดุงููุง ูุนุงู.',
        'ููุถูุน ุดูู! ุฏุนูู ุฃุชูุงููู ูู ููุธูุฑ ูุฎุชูู ูุฏ ูุซุฑู ููููุง ูู.',
      ],
      egyptian: [
        'ุงูููุถูุน ุฏู ููู ุฃูู. ุฎูููู ุฃูููู ุฑุฃูู ุจุตุฑุงุญุฉ ูุจุฏูู ูู ูุฏูุฑุงู.',
        'ุฃูุง ุดุงูู ุฅู ุงูููุถูุน ุฏู ูุญุชุงุฌ ูุจุตูู ูู ุฃูุชุฑ ูู ุฒุงููุฉ ุนุดุงู ููููู ุตุญ.',
        'ุจุต ูุง ุณูุฏูุ ุงูุญูููุฉ ุฅู ุงูููุถูุน ุฏู ููู ููุงู ูุชูุฑ. ุฎูููู ุฃุฎุชุตุฑูู.',
        'ุฏู ููุถูุน ุญูู ุฃูู! ุชุนุงูู ูุชููู ููู ุจุงูุชูุตูู.',
      ],
      gulf: [
        'ุงูููุถูุน ูุฐุง ููู. ุฎููู ุฃุนุทูู ุฑุฃูู ุจุตุฑุงุญุฉ.',
        'ุฃุดูู ุฅู ุงูููุถูุน ูุฐุง ูุจู ูุดููู ูู ุฃูุซุฑ ูู ุฒุงููุฉ.',
        'ุจุตุฑุงุญุฉุ ุงูููุถูุน ูุฐุง ููู ููุงู ูุซูุฑ. ุฎููู ุฃุฎุชุตุฑูู.',
        'ููุถูุน ุญูู! ุชุนุงู ูุชูุงูุด ููู.',
      ],
      levantine: [
        'ุงูููุถูุน ูุงุฏ ููู ูุชูุฑ. ุฎูููู ุฅุญูููู ุฑุฃูู ุจุตุฑุงุญุฉ.',
        'ุฃูุง ุดุงูู ุฅูู ุงูููุถูุน ูุงุฏ ูุงุฒู ูุดููู ูู ุฃูุชุฑ ูู ุฒุงููุฉ.',
        'ุจุตุฑุงุญุฉุ ุงูููุถูุน ูุงุฏ ููู ุญูู ูุชูุฑ. ุฎูููู ุฃุฎุชุตุฑูู.',
        'ููุถูุน ุญูู! ุชุนุงู ูุญูู ููู ุณูุง.',
      ],
      moroccan: [
        'ุงูููุถูุน ูุงุฏ ููู ุจุฒุงู. ุฎูููู ููููู ุฑุฃูู ุจุตุฑุงุญุฉ.',
        'ุฃูุง ููุดูู ุจูู ุงูููุถูุน ูุงุฏ ุฎุงุตูุง ูุดูููู ูู ุฃูุชุฑ ูู ุฒุงููุฉ.',
        'ุจุตุฑุงุญุฉุ ุงูููุถูุน ูุงุฏ ููู ูุถุฑุฉ ุจุฒุงู. ุฎูููู ูุฎุชุตุฑูู.',
        'ููุถูุน ูุฒูุงู! ุชุนุงู ููุถุฑู ููู.',
      ],
      iraqi: [
        'ุงูููุถูุน ูุฐุง ููู. ุฎููู ุฃฺฏููู ุฑุฃูู ุจุตุฑุงุญุฉ.',
        'ุฃุดูู ุฅูู ุงูููุถูุน ูุฐุง ูุงุฒู ูุดููู ูู ุฃูุซุฑ ูู ุฒุงููุฉ.',
        'ุจุตุฑุงุญุฉุ ุงูููุถูุน ูุฐุง ููู ุญฺู ูุซูุฑ. ุฎููู ุฃุฎุชุตุฑูู.',
        'ููุถูุน ุญูู! ุชุนุงู ูุชูุงูุด ุจูู.',
      ]
    };
    return this.getRandomItem(genericResponses[dialect] || genericResponses.msa);
  },

  generateAdditionalThought(text, dialect, character) {
    const thoughts = {
      msa: [
        'ูู ุงูููู ุฃูุถุงู ุฃู ูุฃุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ุงูุฌูุงูุจ ุงููุฎุชููุฉ ููุฐุง ุงูููุถูุน.',
        'ุฃุนุชูุฏ ุฃู ููุงู ูุฑุตุฉ ูุจูุฑุฉ ููุชุนูู ูุงูููู ูู ูุฐุง ุงููุฌุงู.',
        'ุงูุชุฌุฑุจุฉ ูุงูููุงุฑุณุฉ ููุง ุฃูุถู ูุนูู ูู ูุฐุง ุงูุดุฃู.',
        'ุฃูุตุญู ุจุงูุงุณุชูุฑุงุฑ ูู ุงูุจุญุซ ูุงูุชุนููุ ูุงููุนุฑูุฉ ูุง ุญุฏูุฏ ููุง.'
      ],
      egyptian: [
        'ูููุงู ููู ุฅูู ุชุจุต ููููุถูุน ูู ูู ุงูุฒูุงูุง.',
        'ุฃูุง ุดุงูู ุฅู ููู ูุฑุตุฉ ูุจูุฑุฉ ููุง ูู ุฑูุฒุช ุตุญ.',
        'ุงูุชุฌุฑุจุฉ ุฃุญุณู ูุนูู ูุงููู. ุฌุฑุจ ููุชุชุนูู.',
        'ูุตูุญุชู ููู ุฅูู ุชูุถู ุชุชุนูู ูุชุทูุฑ ููุณู.'
      ],
      gulf: [
        'ูููู ููุงู ุฅูู ุชุดูู ุงูููุถูุน ูู ูู ุงูุฒูุงูุง.',
        'ุฃุดูู ุฅู ููู ูุฑุตุฉ ูุจูุฑุฉ ูู ุฑูุฒุช ุตุญ.',
        'ุงูุชุฌุฑุจุฉ ุฃุญุณู ูุนูู. ุฌุฑุจ ูุจุชุชุนูู.',
        'ูุตูุญุชู ูู ุฅูู ุชุณุชูุฑ ุชุชุนูู ูุชุทูุฑ ููุณู.'
      ],
      levantine: [
        'ูููุงู ููู ุฅูู ุชุดูู ุงูููุถูุน ูู ูู ุงูุฒูุงูุง.',
        'ุฃูุง ุดุงูู ุฅูู ููู ูุฑุตุฉ ูุจูุฑุฉ ููู ูู ุฑูุฒุช ูููุญ.',
        'ุงูุชุฌุฑุจุฉ ุฃุญุณู ูุนูู. ุฌุฑุจ ูุจุชุชุนูู.',
        'ูุตูุญุชู ุฅูู ุฅูู ุชุถู ุชุชุนูู ูุชุทูุฑ ุญุงูู.'
      ],
      moroccan: [
        'ูููู ูุฐูู ุฅูู ุชุดูู ุงูููุถูุน ูู ูู ุงูุฒูุงูุง.',
        'ุฃูุง ููุดูู ุจูู ููู ูุฑุตุฉ ูุจูุฑุฉ ููุง ูู ุฑูุฒุชู ูุฒูุงู.',
        'ุงูุชุฌุฑุจุฉ ุฃุญุณู ูุนูู. ุฌุฑุจ ูุบุงุฏู ุชุชุนูู.',
        'ูุตูุญุชู ููู ุฅูู ุชุจูู ุชุชุนูู ูุชุทูุฑ ุฑุงุณู.'
      ],
      iraqi: [
        'ูููู ููุงู ุฅูู ุชุดูู ุงูููุถูุน ูู ูู ุงูุฒูุงูุง.',
        'ุฃุดูู ุฅูู ููู ูุฑุตุฉ ูุจูุฑุฉ ูู ุฑูุฒุช ุตุญ.',
        'ุงูุชุฌุฑุจุฉ ุฃุญุณู ูุนูู. ุฌุฑุจ ูุจุชุชุนูู.',
        'ูุตูุญุชู ุฅูู ุฅูู ุชุณุชูุฑ ุชุชุนูู ูุชุทูุฑ ููุณู.'
      ]
    };
    return this.getRandomItem(thoughts[dialect] || thoughts.msa);
  },

  generatePersonalTouch(mem, dialect) {
    const nameF = mem.facts.find(f => f.type === 'name');
    const likeF = mem.facts.find(f => f.type === 'likes');

    if (!nameF && !likeF) return null;

    const touches = {
      msa: [],
      egyptian: [],
      gulf: [],
      levantine: [],
      moroccan: [],
      iraqi: []
    };

    if (nameF) {
      touches.msa.push(`ุจุงูููุงุณุจุฉ ${nameF.value}ุ ุฃูุง ุณุนูุฏ ุจุญูุงุฑูุง ูุฐุง.`);
      touches.egyptian.push(`ุนูู ููุฑุฉ ูุง ${nameF.value}ุ ุฃูุง ูุจุณูุท ุฅููุง ุจูุชููู ูุฏู.`);
      touches.gulf.push(`ุจุงูููุงุณุจุฉ ${nameF.value}ุ ุฃูุง ูุจุณูุท ุจุณูุงูููุง.`);
      touches.levantine.push(`ุนูู ููุฑุฉ ${nameF.value}ุ ูุชูุฑ ูุจุณูุท ุจุญูููุง.`);
      touches.moroccan.push(`ุนูู ููุฑุฉ ${nameF.value}ุ ุฃูุง ูุฑุญุงู ุจูุถุฑุชูุง.`);
      touches.iraqi.push(`ุจุงูููุงุณุจุฉ ${nameF.value}ุ ุฃูุง ูุจุณูุท ุจุญฺููุง.`);
    }

    if (likeF) {
      touches.msa.push(`ุฃุนูู ุฃูู ุชุญุจ ${likeF.value}ุ ููุฐุง ูุฏู ุนูู ุฐูู ุฑููุน!`);
      touches.egyptian.push(`ูุฃูุง ุนุงุฑู ุฅูู ุจุชุญุจ ${likeF.value}ุ ุฏู ุฐูู ุนุงูู ูุงููู!`);
      touches.gulf.push(`ูุฃูุง ุฃุนุฑู ุฅูู ุชุญุจ ${likeF.value}ุ ุฐููู ุญูู!`);
      touches.levantine.push(`ูุฃูุง ุจุนุฑู ุฅูู ุจุชุญุจ ${likeF.value}ุ ุฐููู ุญูู ูุชูุฑ!`);
      touches.moroccan.push(`ูุฃูุง ุนุงุฑู ุจูู ูุชุญุจ ${likeF.value}ุ ุฐููู ูุฒูุงู!`);
      touches.iraqi.push(`ูุฃูุง ุฃุนุฑู ุฅูู ุชุญุจ ${likeF.value}ุ ุฐููู ุญูู!`);
    }

    const dialectTouches = touches[dialect] || touches.msa;
    return dialectTouches.length > 0 ? this.getRandomItem(dialectTouches) : null;
  },

  // ==================== ุฑุฏูุฏ ุฅูุฌููุฒูุฉ ====================
  generateEnglishResponse(text, character, messages) {
    const intent = this.detectIntent(text);
    const mem = this.extractFacts(text, character.id);
    const personality = character.personality || 'friendly';

    const responses = {
      greeting: [
        `Hey there! I'm ${character.name}. ${character.greeting || "How can I help you today?"}`,
        `Hello! Welcome! I'm ${character.name}, and I'm here to chat with you! ๐`,
        `Hi! Great to see you! What would you like to talk about?`
      ],
      farewell: [
        "Goodbye! It was great chatting with you! Come back anytime! ๐",
        "See you later! Take care and have an amazing day! โจ",
        "Bye for now! Looking forward to our next conversation! ๐"
      ],
      general: [
        "That's a really interesting point! Let me share my thoughts on this...",
        "Great question! Here's what I think about it...",
        "I love discussing topics like this! Here's my perspective...",
        "That's something I find fascinating. Let me elaborate..."
      ]
    };

    if (intent === 'greeting') return this.getRandomItem(responses.greeting);
    if (intent === 'farewell') return this.getRandomItem(responses.farewell);

    let response = this.getRandomItem(responses.general);

    // Add personality-specific content
    const personalityResponses = {
      wise: "\n\nFrom my experience and knowledge, I believe this topic has many layers worth exploring. The key is to approach it with an open mind and willingness to learn.",
      funny: "\n\nYou know what's funny about this? It reminds me of something hilarious! ๐ But seriously, let me give you a proper answer...",
      mysterious: "\n\nThe answer to this lies deeper than you might think... Let me guide you through the hidden layers of this topic.",
      romantic: "\n\nThere's something beautiful about exploring this topic together. Let me share what my heart tells me...",
      professional: "\n\nFrom a professional standpoint, I'd recommend approaching this systematically. Let me break it down for you.",
      creative: "\n\nThis sparks so many creative ideas! Let me paint a picture of what I envision...",
      caring: "\n\nI appreciate you sharing this with me. Your thoughts and feelings matter, and I'm here to support you.",
      adventurous: "\n\nThis reminds me of an incredible adventure! Let me tell you about it..."
    };

    response += personalityResponses[personality] || personalityResponses.wise;

    // Add follow-up
    response += "\n\nWhat do you think? I'd love to hear more of your thoughts on this! ๐ญ";

    return response;
  },

  // ==================== Streaming simulation ====================
  async streamResponse(text, character, messages, onChunk, onComplete) {
    const fullResponse = this.generateResponse(text, character, messages);
    const words = fullResponse.split(/(\s+)/);
    let accumulated = '';

    for (let i = 0; i < words.length; i++) {
      accumulated += words[i];
      onChunk(accumulated);
      // Variable delay for natural feel
      const delay = words[i].trim() === '' ? 5 : (Math.random() * 30 + 15);
      await new Promise(r => setTimeout(r, delay));
    }

    onComplete(fullResponse);
    return fullResponse;
  }
};